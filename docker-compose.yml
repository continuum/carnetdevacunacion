version: "3.7"

services:
  web:
    image: cdv
    build:
      context: ./
      dockerfile: Dockerfile
    container_name: cdv
    tty: true
    environment:
      - AIRTABLE_API_KEY=${AIRTABLE_API_KEY}
      - AIRTABLE_BASE_ID=${AIRTABLE_BASE_ID}
    ports:
      - 80:80
    volumes:
      - ./:/app/vue
      - /app/vue/node_modules
    command: >
      sh -c "
      npm i --package-lock-only &&
      npm run serve -- --port 80"
